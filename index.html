<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Wave Runner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;overflow:hidden;background:#0b5ed7;font-family:Arial;}
canvas{display:block;background:linear-gradient(#0b5ed7,#084298);}
.ui{position:fixed;top:10px;left:10px;color:#fff;font-weight:bold;}

.notice{
position:fixed;
top:40%;left:50%;
transform:translate(-50%,-50%) scale(0.5);
font-size:40px;font-weight:bold;color:#fff;
text-shadow:0 0 25px #fff;
opacity:0;transition:.4s;
}

.gameover{
position:fixed;inset:0;background:rgba(0,0,0,.7);
display:none;align-items:center;justify-content:center;
flex-direction:column;color:#fff;font-size:28px;
}

#startBtn{
position:fixed;top:50%;left:50%;
transform:translate(-50%,-50%);
padding:15px 30px;font-size:24px;
border:none;border-radius:10px;
}
</style>
</head>
<body>

<div class="ui">
Score: <span id="score">0</span><br>
Level: <span id="level">1</span><br>
High Score: <span id="highScore">0</span>
</div>

<div id="notice" class="notice"></div>

<div class="gameover" id="gameover">
Game Over<br>
<button onclick="continueGame()">Continue</button>
</div>

<button id="startBtn">START</button>
<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;

let score=0, level=1;
let nextLevelScore=1000;
let gameRunning=false, waveUp=false;

let baseGap=210;
let speed=4.5;
let pipeSpacing=300;

let orbColor="#fff";
let highScore=localStorage.getItem("waveHighScore") || 0;
document.getElementById("highScore").innerText=highScore;

const orb={x:120,y:canvas.height/2,r:18};
let bars=[];

function showNotice(text){
let n=document.getElementById("notice");
n.innerText=text;
n.style.opacity=1;
n.style.transform="translate(-50%,-50%) scale(1)";
setTimeout(()=>{
n.style.opacity=0;
n.style.transform="translate(-50%,-50%) scale(0.5)";
},1500);
}

function calculateDifficulty(){
speed = Math.min(4.5 + (level - 1) * 0.15, 6.8);
baseGap = Math.max(210 - (level - 1) * 5, 150);
pipeSpacing = Math.max(300 - (level - 1) * 5, 240);
}

function spawnPipe(){
let center=200+Math.random()*(canvas.height-400);

if(bars.length>0){
let last=bars[bars.length-1];
let diff=center-last.center;
if(Math.abs(diff)>100){
center=last.center+(diff>0?90:-90);
}
}

bars.push({
x:canvas.width,
w:50,
center:center,
gap:baseGap
});
}

function drawOrb(){
ctx.beginPath();
ctx.fillStyle=orbColor;
ctx.arc(orb.x,orb.y,orb.r,0,Math.PI*2);
ctx.fill();
}

function update(){
if(!gameRunning)return;

ctx.clearRect(0,0,canvas.width,canvas.height);

orb.y+=waveUp?-5.2:5.2;
drawOrb();

if(bars.length===0 || canvas.width - bars[bars.length-1].x >= pipeSpacing){
spawnPipe();
}

bars.forEach(b=>{
b.x-=speed;

let topH=b.center-b.gap/2;
let bottomY=b.center+b.gap/2;

ctx.fillStyle="#000";
ctx.fillRect(b.x,0,b.w,topH);
ctx.fillRect(b.x,bottomY,b.w,canvas.height-bottomY);

if(
orb.x+orb.r>b.x &&
orb.x-orb.r<b.x+b.w &&
(orb.y<topH||orb.y>bottomY)
){
endGame();
}
});

bars=bars.filter(b=>b.x+b.w>0);

if(orb.y<0||orb.y>canvas.height) endGame();

score++;

if(score>=nextLevelScore){
level++;
nextLevelScore+=1000;
calculateDifficulty();
showNotice("LEVEL "+level);

if(level==10){
orbColor="#ffcc00";
showNotice("REWARD!");
}

if(level==20){
showNotice("BOSS LEVEL!");
speed+=1;
}
}

if(score>highScore){
highScore=score;
localStorage.setItem("waveHighScore",highScore);
document.getElementById("highScore").innerText=highScore;
}

document.getElementById("score").innerText=score;
document.getElementById("level").innerText=level;

requestAnimationFrame(update);
}

function endGame(){
gameRunning=false;
document.getElementById("gameover").style.display="flex";
}

function continueGame(){
bars=[];
orb.y=canvas.height/2;
document.getElementById("gameover").style.display="none";
gameRunning=true;
update();
}

document.getElementById("startBtn").onclick=function(){
this.style.display="none";
calculateDifficulty();
gameRunning=true;
update();
};

addEventListener("mousedown",()=>waveUp=true);
addEventListener("mouseup",()=>waveUp=false);
addEventListener("touchstart",()=>waveUp=true);
addEventListener("touchend",()=>waveUp=false);
</script>

</body>
</html>
